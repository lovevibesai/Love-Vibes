name = "love-vibes-backend"
main = "src/index.ts"
compatibility_date = "2025-01-18"

# Analytics Engine (LV AI Tracking)
[[analytics_engine_datasets]]
binding = "LV_AI"
dataset = "lv_ai"

# D1 Database Binding (User Profiles, Swipes, Matches)
[[d1_databases]]
binding = "DB"
database_name = "LoveVibesDB"
database_id = "e0f583fa-e713-487a-aad4-a34722368f05"
# Optimize for high-read volume scenarios (Scenario B & C)
performance_hint = "read_heavy"

# KV Namespace Binding (Geosharding Map)
[[kv_namespaces]]
binding = "GEO_KV"
id = "be22cab4461942bdac552afd7215a0fd" # Placeholder

# R2 Bucket Binding (Photos/Videos)
[[r2_buckets]]
binding = "MEDIA_BUCKET"
bucket_name = "love-vibes-media"

# Durable Objects (Real-time Chat & Lobbies)
[[durable_objects.bindings]]
name = "CHAT_ROOM"
class_name = "ChatRoom"

[[durable_objects.bindings]]
name = "MATCH_LOBBY"
class_name = "MatchLobby"

# Migrations for Durable Objects
[[migrations]]
tag = "v1"
new_classes = ["ChatRoom", "MatchLobby"]

# Queue for Async Jobs (Optional: e.g. Image Processing)
[[queues.producers]]
  queue = "media-processing-queue"
  binding = "MEDIA_QUEUE"

[observability]
enabled = true
head_sampling_rate = 1



